<!DOCTYPE html>
<html lang="th">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö | ‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏î‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai&display=swap" rel="stylesheet" />
  <link href="cssindex.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>

</head>

<body>

  <!-- Navbar -->
  <div class="navbar-container">
    <div class="navbar-top"></div>
    <div class="navbar">
      <div class="navbar-left">
        <img src="https://i.postimg.cc/XvS1jwB8/1.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ" class="logo-img" />
        <span>‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏´‡∏≤‡∏£‡πÄ‡∏£‡∏∑‡∏≠</span>
      </div>
    </div>
    <div class=" navbar-bottom">
    </div>
  </div>

  <!-- ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ -->
  <div class="content">
    <div class="login-container">
      <div>
        <!-- ‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡πÅ‡∏•‡∏∞‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏° -->
        <br>
        <div class="login-header">
          <img src="https://i.postimg.cc/XvS1jwB8/1.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâmain" class="logos-img" />
          <span>‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏´‡∏≤‡∏£‡πÄ‡∏£‡∏∑‡∏≠</span>
        </div>
        <br>
        <br>
        <br>
        <h2>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</h2>
        <form id="login-form"> <!-- <form action="home.html" method="GET"> -->
          <label for="student_id">Username</label>
          <input type="text" id="student_id" name="student_id" required />

          <label for="Password">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label>
          <div style="position: relative;">
            <input type="password" id="password" name="password" required />
            <i id="togglePassword" class="fa-solid fa-eye"
              style="position: absolute; right: 10px; top: 43%; transform: translateY(-50%); cursor: pointer;"></i>
          </div>


          <button type="submit">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
        </form>
        <div class="register-link">
          ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ? <a href="register.html">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</a>
        </div>

      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <div class="footer-top">
      <span>¬© 2025 ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏´‡∏≤‡∏£‡πÄ‡∏£‡∏∑‡∏≠</span>
    </div>
    <div class="footer-bottom">
      <span>‡∏´‡∏≤‡∏Å‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ : ‡∏ô.‡∏≠.‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå ‡πÄ‡∏ï‡∏ä‡∏∞‡∏û‡∏á‡∏®‡πå‡∏õ‡∏£‡∏∞‡πÄ‡∏™‡∏£‡∏¥‡∏ê ‡πÇ‡∏ó‡∏£. 089-893-8805</span>
    </div>
  </footer>


  <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡πà‡∏≠‡∏ô </body> -->
  <script>
    const SUPABASE_URL = 'https://nceyapolnyhwzgssfson.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5jZXlhcG9sbnlod3pnc3Nmc29uIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk5MjAwMjUsImV4cCI6MjA2NTQ5NjAyNX0.pCB24tf7CoLoHBGm4opDFk-n43Kc1n16PRgiMYHh8fo';
    const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    document.getElementById('login-form').addEventListener('submit', async function (event) {
      event.preventDefault();

      const enteredUsername = document.getElementById('student_id').value;
      const enteredPassword = document.getElementById('password').value;

      // üëâ ‡πÄ‡∏Ñ‡∏™‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô (hardcoded)
      if (enteredUsername === 'admin' && enteredPassword === '1234') {
        localStorage.setItem('currentUser', 'admin');

        // ‡πÄ‡∏Å‡πá‡∏ö log ‡∏•‡∏á Supabase
        await supabase.from('login_logs').insert([{
          user: 'admin',
          time: new Date().toISOString()
        }]);

        window.location.href = 'home.html'; // home.html ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏°‡∏ô‡∏π admin ‡πÄ‡∏û‡∏¥‡πà‡∏°
        return;
      }

      // üëâ ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (login ‡∏ú‡πà‡∏≤‡∏ô Supabase)
      const email = enteredUsername + '@example.com'; // ‡πÄ‡∏£‡∏≤‡πÉ‡∏ä‡πâ username ‡πÄ‡∏õ‡πá‡∏ô email ‡πÅ‡∏ö‡∏ö‡∏õ‡∏•‡∏≠‡∏°
      const { data, error } = await supabase.auth.signInWithPassword({
        email: email,
        password: enteredPassword
      });

      if (error) {
        alert('‚ùå ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
        return;
      }

      // ‡∏î‡∏∂‡∏á profile ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏°‡∏≤‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô localStorage
      const { data: profileData } = await supabase
        .from('profiles')
        .select('*')
        .eq('id', data.user.id)
        .single();

      localStorage.setItem('currentUser', JSON.stringify(profileData));

      // ‡πÄ‡∏Å‡πá‡∏ö log ‡∏•‡∏á Supabase
      await supabase.from('login_logs').insert([{
        user: enteredUsername,
        time: new Date().toISOString()
      }]);

      window.location.href = 'home.html'; // ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ home ‡∏õ‡∏Å‡∏ï‡∏¥
    });

    // toggle password
    document.getElementById('togglePassword').addEventListener('click', function () {
      const passwordInput = document.getElementById('password');
      const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
      passwordInput.setAttribute('type', type);
      this.classList.toggle('fa-eye');
      this.classList.toggle('fa-eye-slash');
    });
  </script>

</body>

</html>